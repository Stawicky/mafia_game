"use strict";var optionID,killingID,playersAmount=document.querySelector("#players-amount"),mafiaAmount=document.querySelector("#mafia-amount"),startGameBtn=document.querySelector(".modal-start-game .start"),inputPlayersAmount=document.querySelector("input#players-amount"),inputMafiaAmount=document.querySelector("input#mafia-amount"),modalStartGame=document.querySelector(".modal-start-game"),modalBorder=document.querySelector(".modal-border"),boardGame=document.querySelector(".board-game"),boardGameBorder=document.querySelector(".board-game-border"),modalOptions=document.querySelector(".modal-border-option"),arrowAdminPanel=document.querySelector(".arrow-admin"),adminPanel=document.querySelector(".admin-panel"),resetGameButton=document.querySelector("button.reset"),showRolesButton=document.querySelector("button.show-all-roles"),modalCheckingQuestion=document.querySelector(".modal-border-checking-question"),modalQuestionYesBtn=document.querySelector(".modal-border-checking-question button.yes"),modalQuestionNoBtn=document.querySelector(".modal-border-checking-question button.no"),playersLive=[],roleInGame=[],saveOptionsBtn=document.querySelector(".modal-player-option .save"),cancelOptionsBtn=document.querySelector(".modal-player-option .cancel"),inputRename=document.querySelector("input#rename"),selectRole=document.querySelector("select#changeRole"),mafiaIcon="fa-hand-fist",policeIcon="fa-person-military-pointing",medicIcon="fa-stethoscope",jesterIcon="fa-dumpster",sheriffIcon="fa-user-secret",role4Icon="fa-4",getRandomInt=function(e){return Math.floor(Math.random()*e)},countLenght=function(e){return 0<=e&&e<90||180<=e&&e<270?e%90/9+35:10-e%90/9+35},createPlayer=function(e,o){var t=document.createElement("div"),o=360/o*e;t.classList.add("player"),t.setAttribute("id",e),t.style.transform="translate(-50%, -50%) rotate(".concat(o,"deg) translateY(-").concat(countLenght(o),"vh) rotate(-").concat(o,"deg)"),t.innerHTML='<div class="name"></div><div class="options"> <i class="fa-regular fa-address-book"></i></div> <div class="showClass"><i class="fa-solid fa-magnifying-glass"></i> </div> <div class="kill"> <i class="fa-solid fa-skull"></i> </div>',boardGame.appendChild(t),playersLive.push(t),playersButton()},startGame=function(e,o){for(var t=0;t<o;t++)roleInGame.push("mafia");extraRoles();for(var a=roleInGame.length;a<e;a++)roleInGame.push("police");for(var n=0;n<e;n++)createPlayer(n,e);giveRoles()},extraRoles=function(){document.querySelector("input#medic").checked&&roleInGame.push("medic"),document.querySelector("input#jester").checked&&roleInGame.push("jester"),document.querySelector("input#sheriff").checked&&roleInGame.push("sheriff"),document.querySelector("input#role4").checked&&roleInGame.push("role4")},giveRoles=function(){for(var e=[],o=0;o<playersLive.length;o++){var t=getRandomInt(roleInGame.length),a=roleInGame[t];playersLive[o].setAttribute("role",a),e.push(roleInGame[t]),delete roleInGame[t],roleInGame=roleInGame.filter(function(e){return e})}roleInGame=e},checkForm=function(){0<playersAmount.value&&playersAmount.value<21?inputPlayersAmount.classList.remove("errorInput"):inputPlayersAmount.classList.add("errorInput"),0<mafiaAmount.value?inputMafiaAmount.classList.remove("errorInput"):inputMafiaAmount.classList.add("errorInput"),20<playersAmount.value&&alert("Maksymalna licba graczy 20!"),0<playersAmount.value&&0<mafiaAmount.value&&playersAmount.value<21&&(modalStartGame.classList.add("hide"),modalBorder.classList.add("hide"),boardGameBorder.classList.remove("hide"),startGame(playersAmount.value,mafiaAmount.value),playersAmount.value=0,mafiaAmount.value=0)},playersButton=function(){playersLive.forEach(function(e,o){e.querySelector(".kill").setAttribute("onclick","checkingQuestionKill(".concat(o,")")),e.querySelector(".options").setAttribute("onclick","showOptions(".concat(o,")")),e.querySelector(".showClass").setAttribute("onclick","showRole(".concat(o,")"))})},answerKillingYes=function(){playersLive[killingID].classList.add("hide"),modalCheckingQuestion.classList.add("hide")},answerKillingNo=function(){modalCheckingQuestion.classList.add("hide")},checkingQuestionKill=function(e){modalCheckingQuestion.classList.remove("hide"),killingID=e},showOptions=function(e){optionID=e,modalOptions.classList.remove("hide"),inputRename.value=playersLive[e].querySelector(".name").textContent},closeOptions=function(){modalOptions.classList.add("hide"),inputRename.value="",selectRole.value=""},saveOptions=function(){var e,o=optionID;playersLive[o].querySelector(".name").textContent=inputRename.value,""!==selectRole.value&&(playersLive[o].role=selectRole.value),playersLive[o].querySelector(".showClass i").classList.contains("fa-magnifying-glass")||(e=roleInfo(o),playersLive[o].querySelector(".showClass i").className="fa-solid",playersLive[o].querySelector(".showClass i").classList.toggle(e[0]),playersLive[o].style.backgroundColor=e[1]),closeOptions()},rename=function(e,o){playersLive[e].querySelector(".name").textContent=o},showRole=function(e){var o=roleInfo(e);playersLive[e].querySelector(".showClass i").classList.toggle("fa-magnifying-glass"),playersLive[e].querySelector(".showClass i").classList.toggle(o[0]),""===playersLive[e].style.backgroundColor?playersLive[e].style.backgroundColor=o[1]:playersLive[e].style.backgroundColor=""},roleInfo=function(e){var o,t;switch(playersLive[e].role){case"mafia":o=mafiaIcon,t="#6e2626";break;case"police":o=policeIcon,t="#23438b";break;case"medic":o=medicIcon,t="#78700c";break;case"jester":o=jesterIcon,t="#78700c";break;case"sheriff":o=sheriffIcon,t="#78700c";break;case"role4":o=role4Icon,t="#78700c"}return[o,t]},hideAllRole=function(){playersLive.forEach(function(e){e.querySelector(".showClass i").className="fa-solid fa-magnifying-glass",e.style.backgroundColor=""})},resetGame=function(){console.log("Reset game!"),playersLive.forEach(function(e){e.classList.remove("hide")}),hideAllRole(),giveRoles()},showAllRoles=function(){var o=playersLive.length;if(playersLive.forEach(function(e){e.querySelector(".showClass i").classList.contains("fa-magnifying-glass")&&o--}),0==o){hideAllRole();for(var e=0;e<playersLive.length;e++)showRole(e)}else hideAllRole()};startGameBtn.addEventListener("click",checkForm),cancelOptionsBtn.addEventListener("click",closeOptions),saveOptionsBtn.addEventListener("click",saveOptions),inputRename.addEventListener("keypress",function(e){"Enter"===e.key&&saveOptions()}),modalQuestionYesBtn.addEventListener("click",answerKillingYes),modalQuestionNoBtn.addEventListener("click",answerKillingNo),arrowAdminPanel.addEventListener("click",function(){adminPanel.classList.toggle("open")}),resetGameButton.addEventListener("click",resetGame),showRolesButton.addEventListener("click",showAllRoles);